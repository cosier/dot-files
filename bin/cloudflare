#!/bin/bash

if [ -z "$(which cloudflare-dns-update)" ] ; then
  echo "Unable to find :cloudflare-dns-update binary"
  echo "gem install cloudflare-dns-update"
  exit 3
fi

SITES=(
askzune.com
cosier.ca
dojopad.com
tastemykungfu.com
beetflo.com)

for domain in ${SITES[@]}; do
  echo "Cloudflare -> Updating: $domain @$(date)" > ~/.cloudflare.log
  file=~/.dot/dyn/$domain.yml
  CLOUDFLARE_REFRESH='true' \
    ~/.dot/bin/cloudflare-dns-update --configuration $file.new >> ~/.cloudflare.log 2>&1

  if [[ $? != 0 ]]; then
    echo
    echo "Cloudflare update error." >> ~/.cloudflare.log
    echo
    exit 3
  else
    echo "$domain -> Success @ $(date)" >> ~/.cloudflare.log
  fi

  echo
done

# cloudflare-dns-update --configuration ~/.dot/dyn/askzune.com.yml
# cloudflare-dns-update --configuration ~/.dot/dyn/dojopad.com.yml
# cloudflare-dns-update --configuration ~/.dot/dyn/tastemykungfu.com.yml
# cloudflare-dns-update --configuration ~/.dot/dyn/beetflo.com.yml
