(ns commenter.utils
  (:require [commenter.logger]
            [cljs.nodejs :as node]))


(def url-parse (js/require "url"))

(defn host-from-url [url]
  (.-host (.parse url-parse url)))

(defn protocol-from-url [url]
  (.-protocol (.parse url-parse url)))

;; Substring helper
(defn substring? [needle haystack]
  (if haystack
    (if (> (.indexOf haystack needle) 1) true false)
    false))

;; Strip any www. prefix from the host
(defn clean-host [host]
  (.replace host (js/RegExp. "www\\." "g") ""))

(defn is-production? []
  (let [env (-> node/process.env.NODE_ENV)]
    (if (= env "production") true false )))


(defn render-json [something]
  (.stringify js/JSON something null 4 ))

(def root-dir
  (str (js* "__dirname") "/.."))
